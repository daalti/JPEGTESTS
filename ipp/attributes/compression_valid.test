## Developer:   Thomas Griffiths
## Date:        12/07/2010
## Test:        IPP print job compression
## Disclaimer:  File and Contents are HP property.

## USAGE:  ./ipptool -f filename -t printer-uri compression.test
#############################################################
# Wait for printer to be ready
# Wait until job pool is clear
{
    NAME "Wait for printer to be ready"
    OPERATION Get-Jobs

    GROUP operation-attributes-tag
    ATTR charset attributes-charset utf-8
    ATTR naturalLanguage attributes-natural-language en
    ATTR uri printer-uri $uri
    ATTR name requesting-user-name $user
    ATTR keyword which-jobs not-completed

    STATUS successful-ok
    EXPECT !job-id REPEAT-NO-MATCH
}
#############################################################

{
	NAME "Step 3: Print-Job with valid compression"
	OPERATION Print-Job
	GROUP operation-attributes-tag
	ATTR charset attributes-charset utf-8
	ATTR naturalLanguage attributes-natural-language en
	ATTR uri printer-uri $uri
	ATTR name requesting-user-name $user
	ATTR mimeMediaType document-format application/PCLm
	ATTR keyword compression "none"

	FILE $filename
    
	STATUS successful-ok
	EXPECT job-id OF-TYPE integer IN-GROUP job-attributes-tag   ##printer-attributes-tag WITH-VALUE >0
}
#############################################################
# Wait until job queue is clear
{
    NAME "	Step 4: Wait for printer to finish"
    OPERATION Get-Jobs

    GROUP operation-attributes-tag
    ATTR charset attributes-charset utf-8
    ATTR naturalLanguage attributes-natural-language en
    ATTR uri printer-uri $uri
    ATTR name requesting-user-name $user
    ATTR keyword which-jobs not-completed

    STATUS successful-ok
    EXPECT !job-id REPEAT-NO-MATCH
}
