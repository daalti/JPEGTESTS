## Updated By:  Kim Fotheringham
## Updated On:  01/28/2015

## USAGE:  ./ipptool -f filename -t printer-uri PrintQuality.test

## EXAMPLE: ./ipptool -f fileSupportingPCLm.pdf -vt ipp://10.0.1.2/ipp/print PrintQuality.test

## Printer Supported Print Qualities to Define
#draft  = 3
#normal = 4
#high   = 5
#############################################################
# Wait for printer to be ready
# Wait until job pool is clear
{
    NAME "Wait for printer to be ready"
    OPERATION Get-Jobs

    GROUP operation-attributes-tag
    ATTR charset attributes-charset utf-8
    ATTR naturalLanguage attributes-natural-language en
    ATTR uri printer-uri $uri
    ATTR name requesting-user-name $user
    ATTR keyword which-jobs not-completed

    STATUS successful-ok
    EXPECT !job-id REPEAT-NO-MATCH
}
#############################################################
{
	NAME "Get Attributes Information"
	OPERATION Get-Printer-Attributes
	GROUP operation-attributes-tag
	ATTR charset attributes-charset utf-8
	ATTR naturalLanguage attributes-natural-language en
	ATTR uri printer-uri $uri
	ATTR mimeMediaType document-format image/pwg-raster

    ATTR keyword requested-attributes printer-firmware-name

	STATUS successful-ok
    EXPECT printer-firmware-name WITH-VALUE "/.*\..*/" DEFINE-MATCH LINUX DEFINE-NO-MATCH CLASSIC
}
#############################################################
##This test case will test print quality and printer resolutions that usually would not go together.
##Output should print using what Printer FW determines best mode is.
# ======================================================================
{
	NAME "Step 3: Mismatch print-quality and pclm-source-resolution"
	OPERATION Print-Job
	GROUP operation-attributes-tag
	ATTR charset attributes-charset utf-8
	ATTR naturalLanguage attributes-natural-language en
	ATTR uri printer-uri $uri
	ATTR name job-name $filename
	ATTR boolean ipp-attribute-fidelity false
	ATTR name document-name $filename
	ATTR mimeMediaType document-format application/PCLm

	GROUP job-attributes-tag
	ATTR enum print-quality 3
	# This may be valid for older printers: ATTR resolution pclm-source-resolution 600x600dpi
        ATTR resolution pclm-source-resolution 600dpi
	FILE $filename

	STATUS successful-ok
	STATUS successful-ok-ignored-or-substituted-attributes
	EXPECT ?print-quality OF-TYPE enum COUNT 1 IN-GROUP job-attributes-tag
        EXPECT ?pclm-source-resolution OF-TYPE resolution IN-GROUP job-attributes-tag
	EXPECT job-uri OF-TYPE uri COUNT 1 IN-GROUP job-attributes-tag
	EXPECT job-id OF-TYPE integer COUNT 1 IN-GROUP job-attributes-tag WITH-VALUE >0
	EXPECT job-state OF-TYPE enum COUNT 1 IN-GROUP job-attributes-tag WITH-VALUE 3,4,5,6,7,8,9
	EXPECT job-state-reasons OF-TYPE keyword IN-GROUP job-attributes-tag
}

#############################################################
{
    NAME "	Step 4: Wait for job to finish"
    OPERATION Get-Jobs

    GROUP operation-attributes-tag
    ATTR charset attributes-charset utf-8
    ATTR naturalLanguage attributes-natural-language en
    ATTR uri printer-uri $uri
    ATTR name requesting-user-name $user
    ATTR keyword which-jobs not-completed

    STATUS successful-ok
    EXPECT !job-id REPEAT-NO-MATCH
}
#############################################################
