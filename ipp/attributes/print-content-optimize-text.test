## Updated by:    Kim Fotheringham - originally by Thomas Griffiths
## Updated Date:  12/01/2014

## USAGE:  ./ipptool -f filename -t printer-uri text.test

## EXAMPLE: ./ipptool -v -t -f PCLm_letter_600_cjpeg_H16_PgCnt1_ADOBE-RGB__JPG_Source.pdf ipp://10.0.1.121/ipp/print text.test
#############################################################
# Wait for printer to be ready
# Wait until job pool is clear
{
    NAME "Wait for printer to be ready"
    OPERATION Get-Jobs

    GROUP operation-attributes-tag
    ATTR charset attributes-charset utf-8
    ATTR naturalLanguage attributes-natural-language en
    ATTR uri printer-uri $uri
    ATTR name requesting-user-name $user
    ATTR keyword which-jobs not-completed

    STATUS successful-ok
    EXPECT !job-id REPEAT-NO-MATCH
}
#############################################################
{
	NAME "Print job for print-content-optimize (text)"
	OPERATION Print-Job
	GROUP operation-attributes-tag
	ATTR charset attributes-charset utf-8
	ATTR naturalLanguage attributes-natural-language en
	ATTR uri printer-uri $uri
	ATTR name requesting-user-name $user
	ATTR mimeMediaType document-format application/PCLm

	GROUP job-attributes-tag
	ATTR keyword print-content-optimize text

	FILE $filename
    
	STATUS successful-ok
	EXPECT job-id
}

#############################################################
{
    NAME "Get jobs to check until job pool is clear"
    OPERATION Get-Jobs

    GROUP operation-attributes-tag
    ATTR charset attributes-charset utf-8
    ATTR naturalLanguage attributes-natural-language en
    ATTR uri printer-uri $uri
    ATTR name requesting-user-name $user
    ATTR keyword which-jobs not-completed

    STATUS successful-ok
    EXPECT !job-id REPEAT-NO-MATCH
}
#############################################################

{
	NAME "Get print-content-optimize information for text"
	OPERATION Get-Job-Attributes
	GROUP operation-attributes-tag
	ATTR charset attributes-charset utf-8
	ATTR naturalLanguage attributes-natural-language en
	ATTR uri printer-uri $uri
	ATTR name requesting-user-name $user
	ATTR integer job-id $job-id
	ATTR keyword requested-attributes print-content-optimize
    
	STATUS successful-ok
	EXPECT print-content-optimize OF-TYPE keyword WITH-VALUE text
}

